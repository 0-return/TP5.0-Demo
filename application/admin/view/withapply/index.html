<include file="public:top" />
<title>提现管理</title>
</head>
<body>
<include file="public:crumbs" />
<div class="page-container">
    <form action="{{:url('index')}}" method="get">
        <input type="hidden" name="sfields" title="电话号码，收款账号，流水号" value="phone,tocard,processing_person">
    <div class="text-c"> 日期范围：
        <input type="text" autocomplete="off" name="begintime" onfocus="WdatePicker({ maxDate:'#F{$dp.$D(\'datemax\')||\'%y-%M-%d\'}' })" id="datemin" class="input-text Wdate" style="width:120px;">
        -
        <input type="text" autocomplete="off" name="endtime" onfocus="WdatePicker({ minDate:'#F{$dp.$D(\'datemin\')}',maxDate:'%y-%M-%d' })" id="datemax" class="input-text Wdate" style="width:120px;">
        <input type="text" class="input-text" name="reunite" style="width:250px" placeholder="电话号码，收款账号，流水号" >
        <button type="submit" class="btn btn-success" name=""><i class="Hui-iconfont">&#xe665;</i> 搜索</button>
    </div>
    </form>
    <div class="cl pd-5 bg-1 bk-gray mt-20">
        <span class="l"><a href="javascript:;" onclick="_del()" class="btn btn-danger radius"><i class="Hui-iconfont">&#xe6e2;</i> 批量删除</a> <a href="javascript:;" onclick="_edit()" class="btn btn-success radius"><i class="Hui-iconfont">&#xe6ee;</i> 批量处理</a>
    </span>
    <span class="r">共有数据：<strong class="jl">{{$count}}</strong> 条</span> </div>
    <div class="mt-20">
    <table class="table table-border table-bordered table-hover table-bg table-sort">
        <thead>
            <tr class="text-c">
                <th width="25"><input type="checkbox" name="" value=""></th>
                <th width="50">提现用户</th>
                <th width="50">提现金额</th>
                <th width="100">申请时间</th>
                <th width="80">用户支付宝</th>
                <th width="50">用户号码</th>
                <th width="50">处理人</th>
                <th width="100">处理时间</th>
                <th width="50">到账金额</th>
                <th width="100">律所状态</th>
                <th width="50">状态</th>
                <th width="40">操作</th>
            </tr>
        </thead>
        <tbody>
            <volist name="list" id="vo">
            <tr class="text-c">
                <td><input type="checkbox" value={{$vo.id}} name="id"></td>
                <td>
                <a title="编辑" href="javascript:;"  onclick="show('提现记录','{{:url('showByid')}}',{{$vo.uid}},'1000','600')" style="text-decoration:none">{{$vo.username}}</a>
                </td>
                <td>{{$vo.amount}}</td>
                <td>{{:date('Y-m-d H:i:s',$vo['creat_time'])}}</td>
                <td>{{$vo.tocard}}</td>
                <td>{{$vo.phone}}</td>
                <td>{{$vo.processing_person}}</td>
                <eq name="vo.over_time" value="">
                <td></td>
                <else/>
                <td>{{:date('Y-m-d H:i:s',$vo['over_time'])}}</td>
                </eq>
                <td>{{$vo.account}}</td>
                <td>{{$vo.status_cn}}</td>

                <td>
                <eq name="vo.status" value="1">
                    <span class="label label-success radius">已提现</span>
                <else/>
                    <span class="label radius">未通过</span>
                </eq>
                </td>
                <td>
                <eq name="vo.status" value="1">
                    <a style="text-decoration:none" href="javascript:;" title="提现已经处理"><i class="Hui-iconfont">&#xe60e;</i>
                <else/>
                    <a style="text-decoration:none" onClick="_edit(this,{{$vo.id}})" href="javascript:;" title="提现处理"><i class="Hui-iconfont">&#xe606;</i></a>
                </eq>
                <a title='删除' href='javascript:;' onclick='_del(this,"{{$vo.id}}")' class='ml-5' style='text-decoration:none'><i class='Hui-iconfont'>&#xe6e2;</i></a>
                </td>

                
                

            </tr>
            </volist>
        </tbody>
		<if condition="$count gt 10">
        <tbody>
		<tr class="text-c">
			<td colspan="100">{{$page}}</td>
    	</tr>
		</tbody>
		</if>
    </table>
    </div>
</div>
<!--_footer 作为公共模版分离出去-->
<include file="public:footer-style" />

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" src="__PUBLICADMIN__lib/My97DatePicker/4.8/WdatePicker.js"></script>
<script type="text/javascript" src="__PUBLICADMIN__lib/jquery.validation/1.14.0/jquery.validate.js"></script>
<script type="text/javascript" src="__PUBLICADMIN__lib/jquery.validation/1.14.0/validate-methods.js"></script>
<script type="text/javascript" src="__PUBLICADMIN__lib/jquery.validation/1.14.0/messages_zh.js"></script>
<script type="text/javascript">
/*用户-添加*/
function _add(title,url,w,h){
    layer_show(title,url,w,h);
}
/*用户-查看*/
function _show(title,url,id,w,h){
    layer_show(title,url+"?id="+id,w,h);
}

/*用户-退款*/
function _edit(obj = '',id = ''){

    if (!id) 
    {

        layer.msg('功能还未开放，开发中...',{icon: 5,time:3000});return false;
        /*var id = new Array();
        $("input[name='id']:checked").each(function(i){
            id.push($(this).val());//向数组中添加元素
        });*/
    }

    layer.confirm('确认要通过该用户的提现申请吗？',function(index){
        $.ajax({
            type: 'POST',
            url: '{{:url('apply')}}',
            dataType: 'json',
            data:{
                id: id,
            },
            success: function(data){
                if (data.code == 10000) {
                    layer.msg(data.msg,{icon: 6,time:1000});
                    setTimeout('location.reload();',1000);
                }else{
                    layer.msg(data.msg,{icon: 5,time:3000});
                } 
                
            },
            error:function(data) {
                console.log(data.msg);
            },
        });
    });
}
function _del(obj = '',id = ''){
    if (!id) 
    {
        var id = new Array();
        $("input[name='id']:checked").each(function(i){
            id.push($(this).val());//向数组中添加元素
        });
    }
    layer.confirm('确认要删除吗？',function(index){
        $.ajax({
            type: 'POST',
            url: "{{:url('deleteByAjax')}}",
            data:{
                id: id
            },
            dataType: 'json',
            success: function(data){
                if(data.code == 10000){
                    layer.msg(data.msg,{icon: 6,time:1000});
                    setTimeout('location.reload();',1000);
                }else{
                    layer.msg(data.msg,{icon: 6,time:1000});
                }
            },
            error:function(data) {
                alert("系统繁忙");
                location.reload();
            },
        });
    });
}
</script> 
<include file="public:footer" />
